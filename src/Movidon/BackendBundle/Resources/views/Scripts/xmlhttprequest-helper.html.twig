<script>
    var XMLHttpRequestHelper = {
        sendRequest: function(method, path, params, onsuccess, onerror) {
            var xhr = new XMLHttpRequest();
            xhr.open(method, path, true);
            if (typeof params !== 'undefined' && params !== null) {
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.setRequestHeader('Content-length', params.length);
                xhr.setRequestHeader('Connection', 'close');
            }
            // Symfony needs this header
            xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');
            xhr.send(params);

            xhr.onload = function (evt) {
                if (xhr.status === 200) {
                    onsuccess && onsuccess(xhr.response);
                } else {
                    onerror && onerror(xhr.statusText);
                }
            };

            xhr.onerror = onerror;

            xhr.onreadystatechange = function () {
                console.info(xhr);
            }
        }
    };
</script>