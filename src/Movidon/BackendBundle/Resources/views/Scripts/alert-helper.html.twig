<script>
    var AlertHelper = {
        overlay: null,
        currentAlert: null,

        alert: function(selector) {
            if (!this.overlay) {
                var overlay = document.createElement('div');
                overlay.className = 'material-alert-overlay';
                document.body.appendChild(overlay);
                this.overlay = overlay;
                this._addCloseListenerToOverlay();
            }

            this.currentAlert = document.querySelector(selector);
            if (!this.currentAlert) {
                console.error('Alert element does not exists');
                return;
            }

            this.overlay.classList.add('open');
            this.currentAlert.classList.add('open');
            this._dispatchEvent('ma-opened');
        },

        close: function(selector) {
            var alert = document.querySelector(selector);
            if (!alert.classList.contains('open') || alert !== this.currentAlert) {
                return;
            }

            this._close();
        },

        _close: function() {
            this.currentAlert.classList.remove('open');
            this.overlay.classList.remove('open');
            this._dispatchEvent('ma-closed');
        },

        _addCloseListenerToOverlay: function() {
            this.overlay.addEventListener('click', function(evt) {
                evt.preventDefault();
                if (this.currentAlert) {
                    this._close();
                }
            }.bind(this));
        },

        _dispatchEvent: function(evtType) {
            var event;
            // Supports IE
            if (typeof CustomEvent !== 'function') {
                event = document.createEvent('Event');
                event.initEvent(evtType, true, true);
            } else {
                event = new CustomEvent(evtType);
            }

            document.dispatchEvent(event);
        }
    };
</script>